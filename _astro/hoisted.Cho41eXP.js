import{D as d}from"./index.es.B1RiJbf6.js";import{i as h}from"./jwt.CPeqYXpJ.js";import{r as l,u,a as p,b as g}from"./resource-progress.BbVKP_Jh.js";import{p as o}from"./page.C3ddTGlS.js";import{s as m}from"./popup.CdCAhVM2.js";import{r as f}from"./dom.DTPLKm7E.js";import"./hoisted.Dr_jI8dq.js";import"./navigation.DkGZy2pp.js";import"./http.BuCmuCAv.js";import"./roadmap.SDi3zlny.js";import"./index.Bhz7cRIx.js";import"./index.CEvxOxeV.js";class w{resourceId;resourceType;jsonUrl;loaderHTML;containerId;loaderId;constructor(){this.resourceId="",this.resourceType="",this.jsonUrl="",this.loaderHTML=null,this.containerId="resource-svg-wrap",this.loaderId="resource-loader",this.init=this.init.bind(this),this.onDOMLoaded=this.onDOMLoaded.bind(this),this.jsonToSvg=this.jsonToSvg.bind(this),this.handleSvgClick=this.handleSvgClick.bind(this),this.handleSvgRightClick=this.handleSvgRightClick.bind(this),this.prepareConfig=this.prepareConfig.bind(this),this.switchRoadmap=this.switchRoadmap.bind(this),this.updateTopicStatus=this.updateTopicStatus.bind(this)}get loaderEl(){return document.getElementById(this.loaderId)}get containerEl(){return document.getElementById(this.containerId)}prepareConfig(){if(!this.containerEl)return!1;this.loaderHTML=this.loaderEl.innerHTML;const t=this.containerEl.dataset;return this.resourceType=t.resourceType,this.resourceId=t.resourceId,!0}jsonToSvg(t){return t?this.containerEl?(this.containerEl.innerHTML=this.loaderHTML,fetch(t).then(e=>e.json()).then(e=>d(e,{fontURL:"/fonts/balsamiq.woff2"})).then(e=>{f(this.containerEl,e)}).then(()=>l(this.resourceType,this.resourceId)).catch(e=>{if(!this.containerEl)return;const s=`
          <strong>There was an error.</strong><br>
          
          Try loading the page again. or submit an issue on GitHub with following:<br><br>

          ${e.message} <br /> ${e.stack}
        `;this.containerEl.innerHTML=`<div class="error py-5 text-center text-red-600 mx-auto">${s}</div>`})):null:(console.error("jsonUrl not defined in frontmatter"),null)}onDOMLoaded(){if(!this.prepareConfig())return;const e=new URLSearchParams(window.location.search).get("r");e?this.switchRoadmap(`/${e}.json`):this.jsonToSvg(this.resourceType==="roadmap"?`/${this.resourceId}.json`:`/best-practices/${this.resourceId}.json`)}switchRoadmap(t){this.containerEl?.setAttribute("style","");const e=t.split("/").pop()?.replace(".json","");if(window?.history?.pushState){const s=new URL(window.location.href),r=this.resourceType[0];s.searchParams.delete(r),e!==this.resourceId&&s.searchParams.set(r,e),window.history.pushState(null,"",s.toString())}this.jsonToSvg(t)?.then(()=>{})}updateTopicStatus(t,e){if(!h()){m();return}o.set("Updating progress"),u({resourceId:this.resourceId,resourceType:this.resourceType,topicId:t},e).then(()=>{p(t,e),g()}).catch(s=>{alert("Something went wrong, please try again."),console.error(s)}).finally(()=>{o.set("")})}handleSvgRightClick(t){const e=t.target?.closest("g")||{},s=e.dataset?e.dataset.groupId:"";if(!s||e.classList.contains("removed"))return;t.preventDefault();const r=e.classList.contains("done"),n=s.replace(/^\d+-/,"");n.startsWith("ext_link:")||this.updateTopicStatus(n,r?"pending":"done")}handleSvgClick(t){const e=t.target?.closest("g")||{},s=e.dataset?e.dataset.groupId:"";if(!s||(t.stopImmediatePropagation(),e.classList.contains("removed")))return;if(/^ext_link/.test(s)){const i=s.replace("ext_link:","");i.startsWith("roadmap.sh")?window.location.href=`https://${i}`:(window.fireEvent({category:"RoadmapExternalLink",action:`${this.resourceType} / ${this.resourceId}`,label:i}),window.open(`https://${i}`));return}if(/^json:/.test(s)){const i=s.replace("json:","");this.switchRoadmap(i);return}if(/^check:/.test(s)){window.dispatchEvent(new CustomEvent(`${this.resourceType}.topic.toggle`,{detail:{topicId:s.replace("check:",""),resourceType:this.resourceType,resourceId:this.resourceId}}));return}const r=s.replace(/^\d+-/,""),n=e.classList.contains("learning"),c=e.classList.contains("skipped");if(t.shiftKey){t.preventDefault(),this.updateTopicStatus(r,n?"pending":"learning");return}if(t.altKey){t.preventDefault(),this.updateTopicStatus(r,c?"pending":"skipped");return}window.dispatchEvent(new CustomEvent(`${this.resourceType}.topic.click`,{detail:{topicId:r,resourceId:this.resourceId,resourceType:this.resourceType}}))}init(){window.addEventListener("DOMContentLoaded",this.onDOMLoaded),window.addEventListener("click",this.handleSvgClick),window.addEventListener("contextmenu",this.handleSvgRightClick)}}const I=new w;I.init();class T{constructor(){this.init=this.init.bind(this),this.onScroll=this.onScroll.bind(this),this.shareIconsId="page-share-icons"}get shareIconsEl(){return document.getElementById(this.shareIconsId)}onScroll(){if(window.scrollY<100||window.innerWidth<1050)return this.shareIconsEl.classList.add("hidden"),null;this.shareIconsEl.classList.remove("hidden")}init(){this.shareIconsEl&&window.addEventListener("scroll",this.onScroll,{passive:!0})}}const S=new T;S.init();
