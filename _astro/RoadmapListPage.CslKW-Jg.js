import{j as e}from"./jsx-runtime.BPj4-Rfu.js";import{r as m}from"./index.SSXOyoI7.js";import{c as v,a as N}from"./http.CoFfIBz6.js";import{p as h}from"./page.C3ddTGlS.js";import{C as w}from"./CreateRoadmapModal.Dbz8g7ET.js";import{u as g}from"./use-toast.CK2mpur1.js";import{u as R}from"./use-outside-click.BWzraQDw.js";import{M as S}from"./MoreVerticalIcon.C2zGsXKe.js";import{M as k,L as b,S as C}from"./ShareOptionsModal.B8L7vp4B.js";import{S as j}from"./shapes.YxNJTzEI.js";import{T as I}from"./trash-2.BCHzEvBy.js";import{R as _}from"./RoadmapIcon.DUeTpdPA.js";import{S as M,G as D}from"./square-pen.DF2faVUh.js";import{E as y}from"./external-link.oHQw7VBp.js";import{U as f}from"./users.C4ZEoh17.js";import{M as L}from"./map.BwXyMETp.js";import"./jwt.DJKFTm3i.js";import"./index.CEvxOxeV.js";import"./Modal.578cTUuR.js";import"./use-keydown.DCIacX8c.js";import"./classname.VuY_V_HN.js";import"./bundle-mjs.CZZD-8Ii.js";import"./loader-2.B_FIm8op.js";import"./createLucideIcon.D5KecAhY.js";import"./toast.BGQI3kl5.js";import"./use-copy-text.i66JXdki.js";import"./user-round-plus.Dq-iiXeh.js";import"./linkedin.CHMERZzY.js";import"./copy.D23Ip4LR.js";import"./users-round.fAnEjEAx.js";import"./check-circle.BcTfUN19.js";function z(n){const{onDelete:s,onUpdateSharing:o,onCustomize:l}=n,t=m.useRef(null),[a,r]=m.useState(!1);return R(t,()=>{r(!1)}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{disabled:!1,onClick:()=>r(!a),className:"hidden items-center opacity-60 transition-opacity hover:opacity-100 disabled:cursor-not-allowed disabled:opacity-30 sm:flex",children:e.jsx(S,{className:"h-4 w-4"})}),e.jsxs("button",{disabled:!1,onClick:()=>r(!a),className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-none sm:hidden",children:[e.jsx(k,{size:14}),"Options"]}),a&&e.jsx("div",{ref:t,className:"align-right absolute right-auto top-full z-50 mt-1 w-[140px] rounded-md bg-slate-800 px-2 py-2 text-white shadow-md sm:right-0",children:e.jsxs("ul",{children:[o&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),o()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(b,{size:14,className:"mr-2"}),"Sharing"]})}),l&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),l()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(j,{size:14,className:"mr-2"}),"Customize"]})}),s&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),s()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(I,{size:14,className:"mr-2"}),"Delete"]})})]})})]})}function $(n){const{roadmaps:s,onDelete:o,setAllRoadmaps:l}=n,t=g(),[a,r]=m.useState(null);async function p(i){const{response:d,error:c}=await v(`https://api.roadmap.sh/v1-delete-roadmap/${i}`);if(c||!d){console.error(c),t.error(c?.message||"Something went wrong, please try again");return}t.success("Roadmap deleted"),o(i)}async function x(i){h.set("Deleting roadmap"),p(i).finally(()=>{h.set("")})}const u=a&&e.jsx(C,{isDiscoverable:a.isDiscoverable,description:a.description,visibility:a.visibility,sharedFriendIds:a.sharedFriendIds,sharedTeamMemberIds:a.sharedTeamMemberIds,roadmapId:a._id,onClose:()=>r(null),onShareSettingsUpdate:i=>{l(d=>({...d,personalRoadmaps:d.personalRoadmaps.map(c=>c._id===a._id?{...c,...i}:c)}))}});return s.length===0?e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[e.jsx(_,{className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:"Create a roadmap to get started"})]}):e.jsxs("div",{children:[u,e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-sm text-gray-400",children:[s.length," custom roadmap(s)"]})}),e.jsx("ul",{className:"flex flex-col divide-y rounded-md border",children:s.map(i=>e.jsx(T,{roadmap:i,onRemove:x,setSelectedRoadmap:r},i._id))})]})}function T(n){const{roadmap:s,onRemove:o,setSelectedRoadmap:l}=n,t=`https://draw.roadmap.sh/${s._id}`;return e.jsxs("li",{className:"grid grid-cols-1 p-2.5 sm:grid-cols-[auto_172px]",children:[e.jsxs("div",{className:"mb-3 grid grid-cols-1 sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsxs("span",{className:"flex items-center text-xs leading-none text-gray-400",children:[e.jsx(P,{visibility:s.visibility,sharedFriendIds:s.sharedFriendIds}),e.jsx("span",{className:"mx-2 font-semibold",children:"Â·"}),e.jsx(j,{size:16,className:"mr-1 inline-block h-4 w-4"}),s.topics," topic"]})]}),e.jsxs("div",{className:"mr-1 flex items-center justify-start sm:justify-end",children:[e.jsx(z,{onUpdateSharing:()=>{l(s)},onCustomize:()=>{window.open(t,"_blank")},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&o(s._id).finally(()=>{})}}),e.jsxs("a",{href:t,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-300 bg-white px-2.5 py-1.5 text-xs text-black hover:bg-gray-50 focus:outline-none",target:"_blank",children:[e.jsx(M,{className:"inline-block h-4 w-4"}),"Edit"]}),e.jsxs("a",{href:`/r?id=${s._id}`,className:"ml-2 flex items-center gap-2 rounded-md border border-blue-400 bg-white px-2 py-1.5 text-xs hover:bg-blue-50 focus:outline-none text-blue-600",target:"_blank",children:[e.jsx(y,{className:"inline-block h-4 w-4"}),"Visit"]})]})]},s._id)}const F={public:{icon:D,label:"Public"},me:{icon:b,label:"Only me"},team:{icon:f,label:"Team Member(s)"},friends:{icon:f,label:"Friend(s)"}};function P(n){const{visibility:s,sharedFriendIds:o=[]}=n,{label:l,icon:t}=F[s];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 whitespace-nowrap text-xs font-normal",children:[e.jsx(t,{className:"inline-block h-3 w-3"}),e.jsxs("div",{className:"flex items-center",children:[s==="friends"&&o?.length>0&&e.jsx("span",{className:"mr-1",children:o.length}),l]})]})}function E(n){const{roadmaps:s}=n,o=new Set(s.map(t=>t.creator.id)),l=[];for(const t of o){const a=s.find(r=>r.creator.id===t)?.creator;a&&l.push({creator:a,roadmaps:s.filter(r=>r.creator.id===t)})}return s.length===0?e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[e.jsx(L,{className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:"Roadmaps from your friends will appear here"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-sm text-gray-400",children:[s.length," shared roadmap(s)"]})}),e.jsx("div",{children:e.jsx("ul",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:l.map(t=>{const a=t.creator;return e.jsxs("li",{className:"flex flex-col items-start overflow-hidden rounded-md border border-gray-300",children:[e.jsxs("div",{className:"relative flex w-full items-center gap-3 p-3",children:[e.jsx("img",{src:a.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${a.avatar}`:"/images/default-avatar.png",alt:a.name||"",className:"h-8 w-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("h3",{className:"truncate font-medium",children:a.name}),e.jsxs("p",{className:"truncate text-sm text-gray-500",children:[t?.roadmaps?.length||0," shared roadmap(s)"]})]})]}),e.jsx("ul",{className:"w-full",children:t?.roadmaps?.map(r=>e.jsx("li",{className:"relative flex w-full border-t",children:e.jsxs("a",{href:`/r?id=${r._id}`,className:"group inline-grid w-full grid-cols-[auto,16px] items-center justify-between gap-2 px-3 py-2 text-sm text-gray-600 transition-colors hover:bg-gray-100 hover:text-black",target:"_blank",children:[e.jsx("span",{className:"w-full truncate",children:r.title}),e.jsx(y,{size:16,className:"opacity-20 transition-opacity group-hover:opacity-100"})]})},r._id))})]},a.id)})})})]})}const O=[{label:"Personal",value:"personal"},{label:"Shared by Friends",value:"shared"}];function ge(){const n=g(),[s,o]=m.useState(!0),[l,t]=m.useState(!1),[a,r]=m.useState("personal"),[p,x]=m.useState({personalRoadmaps:[],sharedRoadmaps:[]});async function u(){o(!0);const{response:i,error:d}=await N("https://api.roadmap.sh/v1-get-user-roadmap-list");if(d||!i){console.error(d),n.error(d?.message||"Something went wrong, please try again");return}x(i||{personalRoadmaps:[],sharedRoadmaps:[]})}return m.useEffect(()=>{u().finally(()=>{o(!1),h.set("")})},[]),s?null:e.jsxs("div",{children:[l&&e.jsx(w,{onClose:()=>t(!1)}),e.jsxs("div",{className:"mb-6 flex flex-col justify-between gap-2 sm:flex-row sm:items-center sm:gap-0",children:[e.jsx("div",{className:"flex grow items-center gap-2",children:O.map(i=>e.jsx("button",{className:`relative flex w-full items-center justify-center whitespace-nowrap rounded-md border p-1 px-3 text-sm sm:w-auto ${a===i.value?" border-gray-400 bg-gray-200 ":""} w-full sm:w-auto`,onClick:()=>r(i.value),children:i.label},i.value))}),e.jsx("button",{className:"relative flex w-full items-center justify-center rounded-md border p-1 px-3 text-sm sm:w-auto",onClick:()=>t(!0),children:"+ Create Roadmap"})]}),e.jsxs("div",{className:"mt-4",children:[a==="personal"&&e.jsx($,{roadmaps:p?.personalRoadmaps,setAllRoadmaps:x,onDelete:i=>{x({...p,personalRoadmaps:p.personalRoadmaps.filter(d=>d._id!==i)})}}),a==="shared"&&e.jsx(E,{roadmaps:p?.sharedRoadmaps})]})]})}export{ge as RoadmapListPage};
