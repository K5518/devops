<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/sql/content/115-advanced-sql/102-window-functions/index.md"></div> <h1 id="window-functions">Window Functions</h1>
<p>SQL Window functions enable you perform calculations on a set of rows related to the current row. This set of rows is known as a ‘window’, hence ‘Window Functions’.</p>
<p>These are termed so because they perform a calculation across a set of rows which are related to the current row - somewhat like a sliding window.</p>
<p>There are four types of window functions in SQL:</p>
<ul>
<li><strong>Aggregate functions:</strong> These functions compute a single output value for a group of input values (like averages, sums).</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> department, salary,</span></span>
<span class="line"><span style="color:#8BE9FD">AVG</span><span style="color:#F8F8F2">(salary) </span><span style="color:#FF79C6">OVER</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">PARTITION</span><span style="color:#FF79C6"> BY</span><span style="color:#F8F8F2"> department) </span><span style="color:#FF79C6">as</span><span style="color:#F8F8F2"> avg_departmental_salary</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> employee;</span></span>
<span class="line"></span></code></pre>
<ul>
<li><strong>Ranking functions:</strong> These functions allocate a unique rank to each row within each window partition.</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> department, salary,</span></span>
<span class="line"><span style="color:#8BE9FD">RANK</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">OVER</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">PARTITION</span><span style="color:#FF79C6"> BY</span><span style="color:#F8F8F2"> department </span><span style="color:#FF79C6">ORDER BY</span><span style="color:#F8F8F2"> salary </span><span style="color:#FF79C6">DESC</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">as</span><span style="color:#F8F8F2"> salary_rank</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> employee;</span></span>
<span class="line"></span></code></pre>
<ul>
<li><strong>Value functions:</strong> These functions provide information about the window partition or the row’s position within it, for example - <code>FIRST_VALUE</code>, <code>LAST_VALUE</code>, <code>NTH_VALUE</code>.</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> department, salary,</span></span>
<span class="line"><span style="color:#8BE9FD">FIRST_VALUE</span><span style="color:#F8F8F2">(salary) </span><span style="color:#FF79C6">OVER</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">PARTITION</span><span style="color:#FF79C6"> BY</span><span style="color:#F8F8F2"> department </span><span style="color:#FF79C6">ORDER BY</span><span style="color:#F8F8F2"> salary </span><span style="color:#FF79C6">DESC</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">as</span><span style="color:#F8F8F2"> highest_salary</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> employee;</span></span>
<span class="line"></span></code></pre>
<ul>
<li><strong>Offset functions:</strong> The offset functions provide a way of accessing data from another row in the same result set without joining the table to itself. They can answer questions concerning the value on the row before or after the current row, for example - <code>LEAD</code>, <code>LAG</code>.</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> department, salary,</span></span>
<span class="line"><span style="color:#8BE9FD">LAG</span><span style="color:#F8F8F2">(salary) </span><span style="color:#FF79C6">OVER</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">PARTITION</span><span style="color:#FF79C6"> BY</span><span style="color:#F8F8F2"> department </span><span style="color:#FF79C6">ORDER BY</span><span style="color:#F8F8F2"> salary) </span><span style="color:#FF79C6">as</span><span style="color:#F8F8F2"> previous_salary,</span></span>
<span class="line"><span style="color:#8BE9FD">LEAD</span><span style="color:#F8F8F2">(salary) </span><span style="color:#FF79C6">OVER</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">PARTITION</span><span style="color:#FF79C6"> BY</span><span style="color:#F8F8F2"> department </span><span style="color:#FF79C6">ORDER BY</span><span style="color:#F8F8F2"> salary) </span><span style="color:#FF79C6">as</span><span style="color:#F8F8F2"> next_salary</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> employee;</span></span>
<span class="line"></span></code></pre>
<p>In using window functions, the <code>OVER</code> clause defines the windows or group of rows for function to consider, <code>PARTITION BY</code> breaks up the window by a specific column(s), and <code>ORDER BY</code> orders rows within the window.</p>
<p>It’s important to note that SQL window functions do not cause rows to become grouped into a single output row like aggregate methods do. Therefore, they do not reduce the number of rows returned by the query, each row maintains its individual identity.</p>