<h1 id="timestamp">Timestamp</h1>
<p>A “Timestamp” in MongoDB is a specific datatype used for tracking the time of an event or a document modification. It’s a 64-bit value containing a 4-byte incrementing ordinal for operations within a given second and a 4-byte timestamp representing the seconds since the Unix epoch (Jan 1, 1970).</p>
<h2 id="when-to-use-timestamp">When to use Timestamp</h2>
<p>Timestamps are mainly used for internal MongoDB operations, such as replication and sharding. They can be useful in tracking the order of operations in a distributed system and ensuring data consistency across multiple nodes.</p>
<h2 id="creating-and-querying-timestamps">Creating and Querying Timestamps</h2>
<p>To create a Timestamp, you can use the BSON Timestamp type. The syntax is as follows:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" lang="javascript"><code><span class="line"><span style="color:#FF79C6;font-weight:bold">new</span><span style="color:#50FA7B"> Timestamp</span><span style="color:#F8F8F2">(t, i);</span></span></code></pre>
<p>Where <code>t</code> is the seconds since the Unix epoch, and <code>i</code> is an incrementing ordinal for operations within a given second.</p>
<p>For example, to create a Timestamp for the current time:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" lang="javascript"><code><span class="line"><span style="color:#FF79C6">var</span><span style="color:#F8F8F2"> currentTimestamp </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Timestamp</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">  Math.</span><span style="color:#50FA7B">floor</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6;font-weight:bold">new</span><span style="color:#50FA7B"> Date</span><span style="color:#F8F8F2">().</span><span style="color:#50FA7B">getTime</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">/</span><span style="color:#BD93F9"> 1000</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#BD93F9">  1</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span></code></pre>
<p>To query documents based on their Timestamp, you can use the <code>$gt</code>, <code>$gte</code>, <code>$lt</code>, or <code>$lte</code> query operators:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" lang="javascript"><code><span class="line"><span style="color:#6272A4">// Find all documents with a Timestamp greater than a specified date</span></span>
<span class="line"><span style="color:#F8F8F2">db.collection.</span><span style="color:#50FA7B">find</span><span style="color:#F8F8F2">({</span></span>
<span class="line"><span style="color:#F8F8F2">  timestampFieldName</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    $gt</span><span style="color:#FF79C6">:</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#50FA7B"> Timestamp</span><span style="color:#F8F8F2">(Math.</span><span style="color:#50FA7B">floor</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6;font-weight:bold">new</span><span style="color:#50FA7B"> Date</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">2021-01-01</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">).</span><span style="color:#50FA7B">getTime</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">/</span><span style="color:#BD93F9"> 1000</span><span style="color:#F8F8F2">), </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">),</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">});</span></span></code></pre>
<p>Keep in mind that using Timestamps for application purposes is generally not recommended, as their main purpose is to serve internal MongoDB operations. Instead, consider using the <code>Date</code> datatype for general-purpose time tracking in your application.</p>
<p>Overall, Timestamps are a powerful tool in MongoDB for managing operations in distributed systems and maintaining data consistency.</p>