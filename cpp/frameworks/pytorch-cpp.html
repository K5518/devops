<h1 id="pytorch-c">PyTorch C++</h1>
<p>PyTorch C++ is the C++ API (Application Programming Interface) for PyTorch. It is also known as LibTorch, which is a library that provides almost all the functionality of PyTorch accessible through C++ language. The main goal of providing a C++ API is to enable high-performance integration with other deep learning platforms and enable seamless operation in enterprise and production-level systems.</p>
<h2 id="installation">Installation</h2>
<p>To use the PyTorch C++ API, you need to install the LibTorch distribution. Follow the instructions on the <a href="https://pytorch.org/cppdocs/installing.html" rel="noopener noreferrer nofollow" target="_blank">official PyTorch C++ API page</a> to install the library based on your platform and requirements.</p>
<h2 id="example-tensors">Example: Tensors</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" lang="cpp"><code><span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &#x3C;</span><span style="color:#F1FA8C">iostream</span><span style="color:#E9F284">></span></span>
<span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &#x3C;</span><span style="color:#F1FA8C">torch/torch.h</span><span style="color:#E9F284">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">int</span><span style="color:#50FA7B"> main</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#6272A4">  // Create a 3x3 matrix with zeros.</span></span>
<span class="line"><span style="color:#F8F8F2">  torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">Tensor a </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> torch</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">zeros</span><span style="color:#F8F8F2">({</span><span style="color:#BD93F9">3</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">3</span><span style="color:#F8F8F2">});</span></span>
<span class="line"><span style="color:#F8F8F2">  std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">cout </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> a </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  // Create a 2x2 matrix with ones and convert to float.</span></span>
<span class="line"><span style="color:#F8F8F2">  torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">Tensor b </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> torch</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">ones</span><span style="color:#F8F8F2">({</span><span style="color:#BD93F9">2</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">2</span><span style="color:#F8F8F2">}).</span><span style="color:#50FA7B">to</span><span style="color:#F8F8F2">(torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">kFloat);</span></span>
<span class="line"><span style="color:#F8F8F2">  std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">cout </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> b </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  // Create a random tensor size 2x2 and specify its type.</span></span>
<span class="line"><span style="color:#F8F8F2">  torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">Tensor c </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> torch</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">randint</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">0</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">10</span><span style="color:#F8F8F2">, {</span><span style="color:#BD93F9">2</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">2</span><span style="color:#F8F8F2">}, torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">kInt);</span></span>
<span class="line"><span style="color:#F8F8F2">  std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">cout </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> c </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  // Perform element-wise addition.</span></span>
<span class="line"><span style="color:#FF79C6">  auto</span><span style="color:#F8F8F2"> sum </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> b </span><span style="color:#FF79C6">+</span><span style="color:#F8F8F2"> c.</span><span style="color:#50FA7B">to</span><span style="color:#F8F8F2">(torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">kFloat);</span></span>
<span class="line"><span style="color:#F8F8F2">  std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">cout </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> sum </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">endl;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<h2 id="example-creating-a-custom-module">Example: Creating a Custom Module</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" lang="cpp"><code><span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &#x3C;</span><span style="color:#F1FA8C">iostream</span><span style="color:#E9F284">></span></span>
<span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &#x3C;</span><span style="color:#F1FA8C">torch/torch.h</span><span style="color:#E9F284">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// Define a custom module.</span></span>
<span class="line"><span style="color:#FF79C6">struct</span><span style="color:#8BE9FD;font-style:italic"> Net</span><span style="color:#F8F8F2"> : torch::nn</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD;font-style:italic">Module</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  Net</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F8F8F2">    fc1 </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> register_module</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">fc1</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">, torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">nn</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Linear</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">784</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">64</span><span style="color:#F8F8F2">));</span></span>
<span class="line"><span style="color:#F8F8F2">    fc2 </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> register_module</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">fc2</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">, torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">nn</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Linear</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">64</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">10</span><span style="color:#F8F8F2">));</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">  torch</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD;font-style:italic">Tensor</span><span style="color:#50FA7B"> forward</span><span style="color:#F8F8F2">(torch</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD;font-style:italic">Tensor</span><span style="color:#FFB86C;font-style:italic"> x</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#F8F8F2">    x </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> x.</span><span style="color:#50FA7B">view</span><span style="color:#F8F8F2">({</span><span style="color:#FF79C6">-</span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">784</span><span style="color:#F8F8F2">});</span></span>
<span class="line"><span style="color:#F8F8F2">    x </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> torch</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">relu</span><span style="color:#F8F8F2">(fc1</span><span style="color:#FF79C6">-></span><span style="color:#50FA7B">forward</span><span style="color:#F8F8F2">(x));</span></span>
<span class="line"><span style="color:#F8F8F2">    x </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> torch</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">log_softmax</span><span style="color:#F8F8F2">(fc2</span><span style="color:#FF79C6">-></span><span style="color:#50FA7B">forward</span><span style="color:#F8F8F2">(x), </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#FF79C6">    return</span><span style="color:#F8F8F2"> x;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">  torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">nn</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">Linear fc1{</span><span style="color:#BD93F9">nullptr</span><span style="color:#F8F8F2">};</span></span>
<span class="line"><span style="color:#F8F8F2">  torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">nn</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">Linear fc2{</span><span style="color:#BD93F9">nullptr</span><span style="color:#F8F8F2">};</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">int</span><span style="color:#50FA7B"> main</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#6272A4">  // Create an instance of the custom module.</span></span>
<span class="line"><span style="color:#F8F8F2">  Net net;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  // Use the custom module.</span></span>
<span class="line"><span style="color:#F8F8F2">  torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">Tensor input </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> torch</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">randn</span><span style="color:#F8F8F2">({</span><span style="color:#BD93F9">2</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">28</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">28</span><span style="color:#F8F8F2">});</span></span>
<span class="line"><span style="color:#F8F8F2">  torch</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">Tensor output </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> net.</span><span style="color:#50FA7B">forward</span><span style="color:#F8F8F2">(input);</span></span>
<span class="line"><span style="color:#F8F8F2">  std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">cout </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> output </span><span style="color:#FF79C6">&#x3C;&#x3C;</span><span style="color:#F8F8F2"> std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#BD93F9"> 0</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>In these examples, we demonstrated how to use various tensor operations and how to create a custom neural network module with PyTorch C++. For more detailed information and tutorials, visit the <a href="https://pytorch.org/cppdocs/" rel="noopener noreferrer nofollow" target="_blank">official PyTorch C++ documentation</a>.</p>