<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/cpp/content/105-pointers-and-references/raw-pointers/101-memory-leakage.md"></div> <h1 id="memory-leakage">Memory Leakage</h1>
<p>Memory leakage occurs when a program allocates memory in the heap but does not release the memory back to the operating system when it is no longer needed. Over time, this leads to exhaustion of available memory, resulting in low system performance or crashes.</p>
<p>In C++, when you use raw pointers, you need to manage the memory allocation and deallocation manually. In many cases, you will use the <code>new</code> keyword to allocate memory for an object in the heap and use <code>delete</code> keyword to deallocate that memory when it’s no longer needed. Forgetting to do this can cause memory leaks.</p>
<p>Here’s an example:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">void</span><span style="color:#50FA7B"> create_memory_leak</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#FF79C6">    int*</span><span style="color:#F8F8F2"> ptr </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6;font-weight:bold"> new</span><span style="color:#FF79C6"> int</span><span style="color:#F8F8F2">[</span><span style="color:#BD93F9">100</span><span style="color:#F8F8F2">];</span><span style="color:#6272A4"> // Allocating memory in the heap for an array of integers</span></span>
<span class="line"><span style="color:#6272A4">    // Some code...</span></span>
<span class="line"><span style="color:#6272A4">    // Code to deallocate the memory is missing: delete[] ptr;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span><span style="color:#6272A4"> // ptr goes out of scope, memory block allocated is not deallocated, causing a memory leak.</span></span>
<span class="line"></span></code></pre>
<p>To avoid memory leaks, you should always ensure that memory is deallocated before a pointer goes out of scope or is reassigned. Some ways to achieve this include using the C++ smart pointers (<code>std::unique_ptr</code>, <code>std::shared_ptr</code>), RAII (Resource Acquisition Is Initialization) techniques, and containers from the C++ standard library that manage memory allocation internally (e.g., <code>std::vector</code>, <code>std::string</code>).</p>
<p>For example, this code will not have a memory leak:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &#x3C;</span><span style="color:#F1FA8C">memory</span><span style="color:#E9F284">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#50FA7B"> no_memory_leak</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F8F8F2">    std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">shared_ptr</span><span style="color:#FF79C6">&#x3C;int</span><span style="color:#F8F8F2">[]</span><span style="color:#FF79C6">></span><span style="color:#F8F8F2"> ptr </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> std</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">make_shared</span><span style="color:#F8F8F2">&#x3C;</span><span style="color:#FF79C6">int</span><span style="color:#F8F8F2">[]>(</span><span style="color:#BD93F9">100</span><span style="color:#F8F8F2">);</span><span style="color:#6272A4"> // Allocating memory in the heap for an array of integers using shared_ptr</span></span>
<span class="line"><span style="color:#6272A4">    // Some code...</span></span>
<span class="line"><span style="color:#F8F8F2">}</span><span style="color:#6272A4"> // shared_ptr goes out of scope and it will automatically deallocate the memory block assigned to it.</span></span>
<span class="line"></span></code></pre>