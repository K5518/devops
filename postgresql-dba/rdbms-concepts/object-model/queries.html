<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/postgresql-dba/content/102-rdbms-concepts/100-object-model/106-queries.md"></div> <h1 id="queries-in-postgresql">Queries in PostgreSQL</h1>
<p>Queries are the primary way to interact with a PostgreSQL database and retrieve or manipulate data stored within its tables. In this section, we will cover the fundamentals of querying in PostgreSQL - from basic <code>SELECT</code> statements to more advanced techniques like joins, subqueries, and aggregate functions.</p>
<h3 id="simple-select-statements">Simple SELECT Statements</h3>
<p>The most basic type of query is a simple <code>SELECT</code> statement. This allows you to retrieve data from one or more tables, and optionally filter or sort the results.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> column1, column2, ...</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> table_name</span></span>
<span class="line"><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> conditions</span></span>
<span class="line"><span style="color:#FF79C6">ORDER BY</span><span style="color:#F8F8F2"> column </span><span style="color:#FF79C6">ASC/DESC</span><span style="color:#F8F8F2">;</span></span></code></pre>
<p>For example, to select all records from the <code>users</code> table:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#FF79C6"> *</span><span style="color:#FF79C6"> FROM</span><span style="color:#F8F8F2"> users;</span></span></code></pre>
<p>To select only the <code>name</code> and <code>email</code> columns for users with an <code>age</code> greater than 25:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#FF79C6"> name</span><span style="color:#F8F8F2">, email </span><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> users </span><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> age </span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> 25</span><span style="color:#F8F8F2">;</span></span></code></pre>
<h3 id="aggregate-functions">Aggregate Functions</h3>
<p>PostgreSQL provides several aggregate functions that allow you to perform calculations on a set of records, such as counting the number of records, calculating the sum of a column, or finding the average value.</p>
<p>Some common aggregate functions include:</p>
<ul>
<li><code>COUNT()</code>: Count the number of rows</li>
<li><code>SUM()</code>: Calculate the sum of a column’s values</li>
<li><code>AVG()</code>: Calculate the average value of a column</li>
<li><code>MIN()</code>: Find the smallest value of a column</li>
<li><code>MAX()</code>: Find the largest value of a column</li>
</ul>
<p>Example: Find the total number of users and the average age:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#8BE9FD"> COUNT</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">AS</span><span style="color:#F8F8F2"> user_count, </span><span style="color:#8BE9FD">AVG</span><span style="color:#F8F8F2">(age) </span><span style="color:#FF79C6">AS</span><span style="color:#F8F8F2"> average_age </span><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> users;</span></span></code></pre>
<h3 id="joins">Joins</h3>
<p>When you want to retrieve related data from multiple tables, you can use a <code>JOIN</code> in the query. There are various types of joins available, such as <code>INNER JOIN</code>, <code>LEFT JOIN</code>, <code>RIGHT JOIN</code>, and <code>FULL OUTER JOIN</code>.</p>
<p>Syntax for a simple <code>INNER JOIN</code>:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> column1, column2, ...</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> table1</span></span>
<span class="line"><span style="color:#FF79C6">JOIN</span><span style="color:#F8F8F2"> table2</span></span>
<span class="line"><span style="color:#FF79C6">ON</span><span style="color:#BD93F9"> table1</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">column</span><span style="color:#FF79C6"> =</span><span style="color:#BD93F9"> table2</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">column</span><span style="color:#F8F8F2">;</span></span></code></pre>
<p>Example: Fetch user details along with their order details, assuming there are <code>users</code> and <code>orders</code> tables, and <code>orders</code> has a <code>user_id</code> foreign key:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#BD93F9"> users</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">name</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">users</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">email</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">orders</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">order_date</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">orders</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">total_amount</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> users</span></span>
<span class="line"><span style="color:#FF79C6">JOIN</span><span style="color:#F8F8F2"> orders</span></span>
<span class="line"><span style="color:#FF79C6">ON</span><span style="color:#BD93F9"> users</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">id</span><span style="color:#FF79C6"> =</span><span style="color:#BD93F9"> orders</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">user_id</span><span style="color:#F8F8F2">;</span></span></code></pre>
<h3 id="subqueries">Subqueries</h3>
<p>Subqueries, also known as “nested queries” or “inner queries”, allow you to use the result of a query as input for another query. Subqueries can be used with various SQL clauses, such as <code>SELECT</code>, <code>FROM</code>, <code>WHERE</code>, and <code>HAVING</code>.</p>
<p>Syntax for a subquery:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> column1, column2, ...</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> ... </span><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> ...) </span><span style="color:#FF79C6">AS</span><span style="color:#F8F8F2"> subquery</span></span>
<span class="line"><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> conditions;</span></span></code></pre>
<p>Example: Find the average age of users who have placed orders from the <code>users</code> and <code>orders</code> tables:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#8BE9FD"> AVG</span><span style="color:#F8F8F2">(age) </span><span style="color:#FF79C6">AS</span><span style="color:#F8F8F2"> average_age</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> users</span></span>
<span class="line"><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> id </span><span style="color:#FF79C6">IN</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">SELECT DISTINCT</span><span style="color:#F8F8F2"> user_id </span><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> orders);</span></span></code></pre>
<p>There’s much more to explore with various types of queries, but this foundational knowledge will serve as a solid basis for further learning and experimentation.</p>
<ul>
<li><a href="https://www.postgresql.org/docs/current/tutorial-select.html" rel="noopener noreferrer nofollow" target="_blank">Querying a Table</a></li>
</ul>